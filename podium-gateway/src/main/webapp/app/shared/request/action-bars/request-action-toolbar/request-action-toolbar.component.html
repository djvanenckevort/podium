<!--
  ~ Copyright (c) 2017. The Hyve and respective contributors
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~
  ~ See the file LICENSE in the root of this repository.
  ~
  -->

<div class="request-action-toolbar" *ngIf="request">

    <form>
        <!-- Draft / Submit -->
        <div class="action-container" *ngIf="isStatus(requestStatus.Draft)">
            <button type="button" class="btn btn-outline-danger" (click)="resetForm()">
                <span jhiTranslate="request.toolbar.reset">Reset</span>
            </button>
            <div class="float-xs-right">
                <button type="button" class="btn btn-outline-primary" (click)="saveDraft()">
                    <span jhiTranslate="request.toolbar.saveDraft">Save draft</span>
                </button>
                <button type="submit" class="btn btn-outline-success" [disabled]="!form.form.valid"
                        (click)="submitDraft()">
                    <span jhiTranslate="request.toolbar.submit">Submit</span>
                </button>
            </div>
        </div>

        <!-- Review -->
        <div class="action-container" *ngIf="isStatus(requestStatus.Review)">

            <!-- Researcher actions -->
            <div *ngIf="isRequestingResearcher()">

                <!-- Validation -->
                <div *ngIf="isReviewStatus(requestReviewStatus.Validation)">
                    <div class="alert alert-info" jhiTranslate="request.toolbar.validation">
                        Your request is currently is waiting for validation.
                    </div>
                </div>

                <!-- Review -->
                <div *ngIf="isReviewStatus(requestReviewStatus.Review)">
                    <div class="alert alert-info" jhiTranslate="request.toolbar.review">
                        Your request has passed the first check and is currently under review.
                    </div>
                </div>

                <!-- Revision -->
                <div *ngIf="isReviewStatus(requestReviewStatus.Revision)">
                    <button type="button" class="btn btn-outline-default" (click)="cancel()">
                        <span jhiTranslate="request.toolbar.cancel">Cancel</span>
                    </button>
                    <div class="float-xs-right">
                        <button type="button" class="btn btn-outline-info" (click)="saveRequest()">
                            <span jhiTranslate="request.toolbar.save">Save</span>
                        </button>
                        <button type="submit" class="btn btn-outline-primary"
                                (click)="submitRequest()">
                            <span jhiTranslate="request.toolbar.saveAndSubmit">Save and submit</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Coordinator actions -->
            <div *ngIf="isRequestCoordinator()">
                <!-- Validation -->
                <div *ngIf="isReviewStatus(requestReviewStatus.Validation)">

                    <!-- Additional actions -->
                    <div class="form-group">
                        <label for="validationCheck">
                            <input type="checkbox"
                                   name="validationCheck"
                                   id="validationCheck"
                                   [(ngModel)]="checks.validation" />
                            <span jhiTranslate="request.toolbar.checks.validation" class="check-helper-text">
                                I hereby validate this request.
                                Upon sending for review all organisation reviewers will be notified.
                            </span>
                        </label>
                    </div>

                    <!-- State actions -->
                    <button type="button" class="btn btn-outline-danger" (click)="rejectRequest()">
                        <span jhiTranslate="request.toolbar.reject">Reject</span>
                    </button>
                    <div class="float-xs-right">
                        <button type="button" class="btn btn-outline-primary" (click)="requireRevision()">
                            <span jhiTranslate="request.toolbar.requestRevision">Request revision</span>
                        </button>
                        <button type="submit" class="btn btn-outline-success" (click)="validateRequest()"
                                [disabled]="!checks.validation">
                            <span jhiTranslate="request.toolbar.sendForReview"
                                  tooltip="Please validate the request by checking the box above."
                                  [isDisabled]="checks.validation">Send for review</span>
                        </button>
                    </div>
                </div>

                <!-- Coordinator during Review -->
                <div *ngIf="isReviewStatus(requestReviewStatus.Review)">
                    <button type="button" class="btn btn-outline-danger" (click)="rejectRequest()">
                        <span jhiTranslate="request.toolbar.reject">Reject</span>
                    </button>
                    <div class="float-xs-right">
                        <button type="button" class="btn btn-outline-default" (click)="requireRevision()">
                            <span jhiTranslate="request.toolbar.requestRevision">Request revision</span>
                        </button>
                        <button type="button" class="btn btn-outline-primary" (click)="approveRequest()">
                            <span jhiTranslate="request.toolbar.approve">Approve</span>
                        </button>
                    </div>
                </div>

                <!-- Organisation coordinator during revision -->
                <div *ngIf="isReviewStatus(requestReviewStatus.Revision)">
                    <div class="alert alert-info" jhiTranslate="request.toolbar.revision">
                        The request is currently in revision.
                    </div>
                </div>
            </div>

            <!-- Reviewer actions -->
            <div *ngIf="isRequestReviewer()">

                <!-- Review -->
                <div class="float-xs-right">
                    <button type="button" class="btn btn-outline-primary" (click)="submitReview()">Submit review</button>
                </div>
            </div>
        </div>
    </form>

</div>
